---
title: 博客功能添加完善！
date: 2022/07/04 20:45:48
categories:
 - [建站日志]
tags:
 - 小破站基建记录
fancybox: false
description: "博客功能添加与个人踩坑指南💪"
---
+++danger 增加夜间主题配色与新字体
将夜间主题调整成荧光色，添加新字体代替原来，看文章更舒服一些
+++

+++danger 添加网易云音乐
网易云音乐位于网站左下方，可以直接访问网易云音乐的歌单网址，通过[config.yml]{.yellow}下配置[audio]{.red}即可,填入自己喜欢的歌单地址，支持多个
+++

+++success 更换图床
将图床更换了一下
+++

+++warning 添加github贡献图标表
下载插件 hexo-filter-git calendar再在config中配置，将其放入main id标签中
+++

+++warning 加了条狗
如题
+++

+++warning 修复git贡献图
图经常失效，不过好在最近稳定了
+++

+++success Github Action为博客添加自动化CI
因为博客的源码和写博客的源码是两份且在不同分支下，所以每次写完都要先用Hexo命令构建部署到远端，然后再将本地的md文章push到另一条分支，虽然不是什么大事，但实际上还是比较麻烦且耗时间的，因为要等待博客构建部署
在百度时公司项目是使用github CI实现自动化的，现在在He3做项目则是使用Github Action将pr自动进行测试，秉承着能少一份工作就少一份工作的原则，我决定实现将md博客push之后自动用Github Action部署
首先终端输入 `ssh-keygen -f github-deploy-key`生成秘钥，将pub公钥添加到项目Setting下的Deploy keys中（注意下方 `Allow Write access`要勾上），将私钥添加到Secrets的Actions中，然后在写博客的分支下的 `.github`目录下新建 `workflows`目录并新建xxx.yml，然后将代码cv进去

```yml
# This is a basic workflow to help you get started with Actions

name: CI

# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build"
  build:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      - name: Checkout source
        uses: actions/checkout@v3
        with:
            ref: master

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
              node-version: '16'

      - name: Setup Hexo
        env: 
                # ACTION_DEPLOY_KEY
                ACTION_DEPLOY_KEY: ${{ secrets.ACTION_DEPLOY_KEY }}
        run: |
                    mkdir -p ~/.ssh/
                    echo "$ACTION_DEPLOY_KEY"> ~/.ssh/id_rsa
                    chmod 700 ~/.ssh
                    chmod 600 ~/.ssh/id_rsa
                    ssh-keyscan github.com >> ~/.ssh/known_hosts
                    git config --global user.email "962475158@qq.com"
                    git config --global user.name "EvilMoOd"
                    npm install hexo-cli -g
                    npm install
      - name: Deploy
        run: |
            hexo clean
            hexo deploy
```

这里主要踩了以下的坑

1. node版本低，因为cv的别人的代码，所以需要升级一下node版本 `actions/setup-node@v3`
2. `fatal: could not read Username for 'https://github.com': No such device or address`这个问题解决了好久，一直卡在这里
3. 在我反复设置秘钥以及确定其他地方没问题后，我开始找到hexo-deploy-git这个项目下的issue，所幸我找到了解决方法，在写博客分支下的 `_config.yml`中，更新deploy的git地址，将https改成SSH，终于成功了

自动部署之后：感觉写博客更带劲了，写完只需要push就可以自动部署，不需要再手动执行Hexo命令，节省了它编译部署的时间，也更舒心了
+++

+++warning 修复图床
微博图床挂了，换了一下地址
+++

+++success 优化代码块显示
代码高亮有点问题，进行修复，并且优化了显示效果，使其更贴合文章
+++

+++success 优化搜索显示
添加了文章内容的搜索指引，不会出现只显示标题这种莫名其妙的结果
+++

+++success 博客添加到谷歌搜索中
将博客网站添加到谷歌爬虫中，不知道处理多久才显示
+++

+++danger 删除git图
地址无限挂掉，没法用了，直接把这个功能下掉得了
+++

+++danger 下掉技术栈栏
感觉略显多余，具体可以转至github stars进行查看，未来将计划下掉面筋，重新开个github project用issue来进行维护，能更好地进行分类展示搜索等
+++
